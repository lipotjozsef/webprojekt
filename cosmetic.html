<!-- TODO:flappy bird kinézet, üres kezelése, 
 base sapka szárny kinézet, sapkát 
 sapkás részre szárnyat szárnyas részre, ne lehessen többet egyhelyre-->
<!DOCTYPE html>
<html lang="hu">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flappy Bird</title>
  <link rel="stylesheet" href="styles/main.css" />
  <link rel="stylesheet" href="cosmetic/cosmetic.css">
</head>

<body onload="moneyAppear(),alreadybought()"> 
  <!-- ///////////// HEADER ///////////// -->
  <header id="title">
    <div class="titleDiv">
      <img src="kepek/title.png" alt="">
    </div>
  </header>

  <!-- ///////////// MAIN ///////////// -->
  <main>
    <div class="mainDiv">
      <section class="menu" id="CosmeticMenu">
        <section id="cosmeticBase">
          <div class="keret2">
            <img src="kepek/kozmetikai_logo.png" alt="" width="40px" class="cosm_logo">
            <div>
              <div id="balance"  style="position: static; padding-bottom:10px ; display:inline-block">
              </div>
              <img src="kepek/coin.png" alt="" height="50px" width="55px" class="coin">
            </div>

          </div>
          <div class="CosmeticOptions">
            <div>
              <label for="gomb">sötétmód</label>
              <button id="gombAlap" onclick="animacio()" style="margin-top:25px;">
                <div id="gomb"></div>
              </button>
            </div>
            <div>

              <label for="tema">téma</label>
              <select name="temajeloles" id="" oninput="backgroundChange()" onclick="borderRadiusChange()" >
                <option value="flappybird-bg.png" >Klasszikus</option>
                <option value="flappybird-bg2.png">CandyLand</option>
                <option value="flappybird-bg3.png">Sunset</option>
              </select>

            </div>
            <hr style="border:1px solid black;margin-top:25px;">
          </div>
          <div style="position:relative; overflow-y: scroll; padding:10px; height:290px;">
            <div id="cosmeticBaseRow">
              <div class="card">
                <div class="overlay "  id="1" onclick="buy(1)"> 
                  <!-- !! -->
                </div>
                <div class="item" style="width:100px;height:100px;padding:25px;" ondrop="drop(event,this.id),kinezet()" id="item1" ondragover="allowDrop(event)">
                  <img src="kepek/hat1.png" id="hat-1" alt="" width="100"  draggable="true" ondragstart="drag(event, this.id)">
                </div>
                <div id="1">
                  <div class="price-n" style="bottom:46%;right:68%;"> 1</div>
                  <div class="price" style="right:55%;bottom:46%;"></div>
                </div>
              </div>
              <div class="card" >
                <div class="overlay " id="12" onclick="buy(12)" >
                </div>
                <div class="item" style="padding-top:25px; margin:15px; width:100px;height:100px;" ondrop="drop(event,this.id),kinezet()" id="item2" ondragover="allowDrop(event)">
                  <img src="kepek/hat2.png"  draggable="true" id="hat-2" alt="" width="100%" ondragstart="drag(event, this.id)">
                </div>
                <div id="12">

                  <div class="price-n" style="bottom:46%;right:22%;"> 12</div>
                  <div class="price" style="right:9%;bottom:46%;"></div>
                </div>
              </div>
            </div>
            <div id="cosmeticBaseRow" >
              <div class="card " >
                <div class="overlay " id="25" onclick="buy(25)">
                </div>
                <div class="item" ondrop="drop(event,this.id),kinezet()" id="item3"  ondragover="allowDrop(event)" style="width:100px;height:100px;">
                  <img src="kepek/wing1.png" draggable="true" ondragstart="drag(event,this.id)" alt="" id="wing-3" width="105%" style="padding-left:25px;padding-top:15px;">
                </div>
                <div id="25">
                  <div class="price-n" style="top:98%; left:90px;"> 25</div>
                  <div class="price" style="left:125px; top:94%;"></div>
                </div>
              </div>
              <div class="card"  >
                <div class="overlay" id="50" onclick="buy(50)">
                </div>
                <div class="item" style="padding:25px;width:100px;height:100px;" id="item4"  ondrop="drop(event,this.id),kinezet()" ondragover="allowDrop(event)">
                  <img src="kepek/wing2.png" draggable="true" ondragstart="drag(event,this.id)" id="wing-4" alt="" width="100%">
                </div>
                <div id="50">
                  <div class="price-n" style="top:98%;right:80px;"> 50</div>
                  <div class="price" style="right:34px;top:94%;"></div>
                </div>
              </div>
            </div>
            <div id="cosmeticBaseRow">
              <div class="card">
                <div class="overlay" id="89" onclick="buy(89)" >
                </div>
                <div class="item" style="padding:25px;width:100px;height:100px;" id="item5"  ondrop="drop(event,this.id),kinezet()" ondragover="allowDrop(event)">
                  <img src="kepek/wing3.png"  draggable="true" ondragstart="drag(event,this.id)" id="wing-5" alt="" width="100%">
                </div>
                <div id="89">
                  <div class="price-n" style="top:156%; left:93px;"> 89</div>
                  <div class="price" style="left:125px;top:153%;"></div>
                </div>
              </div>
              <div class="card">
                <div class="overlay" id="140" onclick="buy(140)">
                </div>
                <div class="item" style="padding:25px;width:100px;height:100px;" id="item6"  ondrop="drop(event,this.id),kinezet()" ondragover="allowDrop(event)">
                  <img src="kepek/wing4.png"  draggable="true" ondragstart="drag(event, this.id)" id="wing-6" alt="" width="100%">
                </div>
                <div id="140">
                  <div class="price-n" style="top:156%; right:80px;"> 140</div>
                  <div class="price" style="right:34px;top:153%;"></div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </section>

      <div id="gameContainer">
        <div class="keret">
          <p>HIGHSCORE - <span id="hs">0</span></p>
        </div>
        <section id="playArea"></section>
        <section id="cosmeticsArea">
          <div class="overlay-window">
            <button onclick="vissza()" class="visszagomb"> < </button>
            <img src="kepek/flappybird.png" alt="" height="100%" width="35%"    style="position:relative; left:30%; top:40px;" id="bird-skin">
            <div id="div1" ondrop="drop(event, this.id), kinezet()" ondragover="allowDrop(event)" style="width:100px;height:100px;border:3px dashed rgba(0, 0, 0, 0.274); position: relative; bottom:350px; margin:15px;"></div>
            <div id="div2" ondrop="drop(event, this.id), kinezet()" ondragover="allowDrop(event)" style="width:100px;height:100px;border:3px dashed rgba(0, 0, 0, 0.274); position: relative; bottom:350px; margin:15px;"></div>
          </div>
        </section>
          <section class="menu" id="PauseMenu"></section>
          <section class="menu" id="StartMenu"></section>
      </div>
    </div>

    <div onclick = "megnyitas()" style="padding:15px; background-color: gainsboro; width:20%; margin:15px;">megnyitás</div>

  </main>

  <!-- ///////////// FOOTER ///////////// -->
  <footer>
    <p>Jedlik 2024 - Web</p>
  </footer>
<script>
  function allowDrop(ev) {
    ev.preventDefault();
  }

  function drag(ev, id) {
    ev.dataTransfer.setData("text", ev.target.id);
 
  }


  function drop(ev, id) {
    let elementCount = document.getElementById(id).childNodes.length;
    var data = ev.dataTransfer.getData("text");

    if ((elementCount == 0 && (id == "div1" || id == "div2")))
      {
        
        if (id == "div1" && data.includes("hat")){
          ev.preventDefault();
          ev.target.appendChild(document.getElementById(data));
          
        }
        else if (id == "div2" && data.includes("wing")){
          ev.preventDefault();
          ev.target.appendChild(document.getElementById(data));
          
        }
      }
      /// ha az id utolsó karaktere benne van a datában 
      let index = id.length - 1;
      let lastChar = id.charAt(index);
      
      let index2 = data.length - 1;
      let lastChar2 = data.charAt(index2);
      if (id != "div1" && (id != "div2") && (lastChar == lastChar2)){
        ev.preventDefault();
        ev.target.appendChild(document.getElementById(data));
        
      }
      console.log(ev.target.childNodes.length);
      
    }
    function kinezet(){
      const div1 = document.getElementById("div1");
      const div2 = document.getElementById("div2");
      const div1Nodes = div1.childNodes.length;
      const div2Nodes = div2.childNodes.length;

      console.log(div1Nodes);
      let bird = document.getElementById("bird-skin");
      if (div1Nodes == 0 && div2Nodes == 0){
        bird.src = "kepek/flappybird.png";
      }
      if(div1Nodes == 0 && div2Nodes != 0){
        let id1 = "_";
        let id2 = div2.getElementsByTagName("img")[0].id;
        
        let kepSrc = "kepek/" + id1 + id2 + ".png" ;
        bird.src = kepSrc;
      }
      if (div1Nodes != 0 && div2Nodes == 0){
        let id2 = "_";
        let id1 = div1.getElementsByTagName("img")[0].id;
        
        let kepSrc = "kepek/" + id1 + id2 + ".png" ;
        bird.src = kepSrc;
      }
      if (div1Nodes != 0 && div2Nodes != 0){
        let id1 = div1.getElementsByTagName("img")[0].id;
        let id2 = div2.getElementsByTagName("img")[0].id;

        let kepSrc = "kepek/" + id1 + id2 + ".png" ;
        bird.src = kepSrc;
      }

    }
</script>
  <script src="scriptek/CS_system_kiegeszites.js"></script>
  <script src="scriptek/game.js"></script>
  <script src="cosmetic/cosmetic.js"></script>
</body>

</html>